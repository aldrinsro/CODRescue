<!-- Sidebar avec animation - Thème Opérateur Logistique Bleu -->
<div id="sidebar" class="flex-shrink-0 relative h-full transition-all duration-300 ease-in-out shadow-2xl border-r overflow-hidden" style="width: 256px; background: linear-gradient(to bottom, var(--logistic-primary), var(--logistic-dark)); border-color: var(--logistic-border-accent); color: var(--logistic-text-light);">
    <!-- Header sans bouton toggle (déplacé dans header.html) -->
    <div class="p-4 border-b flex items-center justify-between" style="border-color: var(--logistic-border-accent);">
        <div id="logo-text" class="transition-all duration-300 opacity-100">
            <h1 class="text-xl font-bold whitespace-nowrap" style="color: var(--logistic-text-light);">YZ-CMD</h1>
            <p class="text-sm whitespace-nowrap" style="color: var(--logistic-text-light); opacity: 0.8;">Opérateur Logistique</p>
        </div>
        <button id="sidebar-toggle" class="p-2 rounded-lg transition-colors duration-200 lg:hidden" style="hover:background-color: var(--logistic-hover-bg);">
            <i class="fas fa-times text-lg" style="color: var(--logistic-text-light);"></i>
        </button>
    </div>
    
    <!-- Navigation Menu -->
    <nav class="mt-4 flex-1 overflow-y-auto">
        <!-- Gestion de Commandes Dropdown -->
        <div class="mb-2">
            <div id="dropdown-commandes" class="flex items-center justify-between px-4 py-2 cursor-pointer hover:bg-opacity-20 hover:bg-white transition-all duration-200" style="color: var(--logistic-text-light); opacity: 0.8; border-color: var(--logistic-border-accent);">
                <div class="flex items-center">
                    <i class="fas fa-box-open mr-2 flex-shrink-0"></i>
                    <span class="transition-all duration-300 opacity-100 whitespace-nowrap">GESTION DE COMMANDES</span>
                </div>
                <i id="chevron-commandes" class="fas fa-chevron-down text-sm transition-all duration-300 ease-in-out"></i>
            </div>
            <ul id="menu-commandes" class="ml-2 hidden transition-all duration-300 ease-in-out">
                <li>
                    <a href="{% url 'operatLogistic:home' %}" class="flex items-center px-4 py-3 transition-all duration-200 transform hover:translate-x-1 border-l-4 border-transparent hover:shadow-lg" style="color: var(--logistic-text-light); hover:background-color: var(--logistic-hover-bg); hover:border-color: var(--logistic-border-accent);">
                        <i class="fas fa-home text-lg mr-3 transition-transform duration-200 flex-shrink-0" style="color: var(--logistic-text-light); opacity: 0.8;"></i>
                        <span class="transition-all duration-300 opacity-100 whitespace-nowrap">Tableau de bord</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'operatLogistic:liste_commandes' %}" class="flex items-center px-4 py-3 transition-all duration-200 transform hover:translate-x-1 border-l-4 border-transparent hover:shadow-lg" style="color: var(--logistic-text-light); hover:background-color: var(--logistic-hover-bg); hover:border-color: var(--logistic-border-accent);">
                        <i class="fas fa-truck text-lg mr-3 transition-transform duration-200 flex-shrink-0" style="color: var(--logistic-text-light); opacity: 0.8;"></i>
                        <span class="transition-all duration-300 opacity-100 whitespace-nowrap">Mes commandes</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'operatLogistic:commandes_renvoyees_preparation' %}" class="flex items-center px-4 py-3 transition-all duration-200 transform hover:translate-x-1 border-l-4 border-transparent hover:shadow-lg" style="color: var(--logistic-text-light); hover:background-color: var(--logistic-hover-bg); hover:border-color: var(--logistic-border-accent);">
                        <i class="fas fa-undo text-lg mr-3 transition-transform duration-200 flex-shrink-0" style="color: var(--logistic-text-light); opacity: 0.8;"></i>
                        <span class="transition-all duration-300 opacity-100 whitespace-nowrap">Renvoyées en préparation</span>
                    </a>
                </li>

            </ul>
        </div>
        
        <!-- Service Dropdown -->
        <div class="mb-2">
            <div id="dropdown-service" class="flex items-center justify-between px-4 py-2 cursor-pointer hover:bg-opacity-20 hover:bg-white transition-all duration-200" style="color: var(--logistic-text-light); opacity: 0.8; border-color: var(--logistic-border-accent);">
                <div class="flex items-center">
                    <i class="fas fa-concierge-bell mr-2 flex-shrink-0"></i>
                    <span class="transition-all duration-300 opacity-100 whitespace-nowrap">SERVICE</span>
                </div>
                <i id="chevron-service" class="fas fa-chevron-down text-sm transition-all duration-300 ease-in-out"></i>
            </div>
            <ul id="menu-service" class="ml-2 hidden transition-all duration-300 ease-in-out">
                <li>
                    <a href="{% url 'operatLogistic:commandes_reportees' %}" class="flex items-center px-4 py-3 transition-all duration-200 transform hover:translate-x-1 border-l-4 border-transparent hover:shadow-lg" style="color: var(--logistic-text-light); hover:background-color: var(--logistic-hover-bg); hover:border-color: var(--logistic-border-accent);">
                        <i class="fas fa-clock text-lg mr-3 transition-transform duration-200 flex-shrink-0 text-yellow-400"></i>
                        <span class="transition-all duration-300 opacity-100 whitespace-nowrap">Reportées</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'operatLogistic:commandes_livrees_partiellement' %}" class="flex items-center px-4 py-3 transition-all duration-200 transform hover:translate-x-1 border-l-4 border-transparent hover:shadow-lg" style="color: var(--logistic-text-light); hover:background-color: var(--logistic-hover-bg); hover:border-color: var(--logistic-border-accent);">
                        <i class="fas fa-box-open text-lg mr-3 transition-transform duration-200 flex-shrink-0 text-blue-400"></i>
                        <span class="transition-all duration-300 opacity-100 whitespace-nowrap">Partiellement Livrées</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'operatLogistic:commandes_livrees_avec_changement' %}" class="flex items-center px-4 py-3 transition-all duration-200 transform hover:translate-x-1 border-l-4 border-transparent hover:shadow-lg" style="color: var(--logistic-text-light); hover:background-color: var(--logistic-hover-bg); hover:border-color: var(--logistic-border-accent);">
                        <i class="fas fa-exchange-alt text-lg mr-3 transition-transform duration-200 flex-shrink-0 text-purple-400"></i>
                        <span class="transition-all duration-300 opacity-100 whitespace-nowrap">Avec Changement</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'operatLogistic:commandes_livrees' %}" class="flex items-center px-4 py-3 transition-all duration-200 transform hover:translate-x-1 border-l-4 border-transparent hover:shadow-lg" style="color: var(--logistic-text-light); hover:background-color: var(--logistic-hover-bg); hover:border-color: var(--logistic-border-accent);">
                        <i class="fas fa-check-circle text-lg mr-3 transition-transform duration-200 flex-shrink-0 text-green-400"></i>
                        <span class="transition-all duration-300 opacity-100 whitespace-nowrap">Livrées</span>
                    </a>
                </li>
                <li>
                    <a href="{% url 'operatLogistic:commandes_retournees' %}" class="flex items-center px-4 py-3 transition-all duration-200 transform hover:translate-x-1 border-l-4 border-transparent hover:shadow-lg" style="color: var(--logistic-text-light); hover:background-color: var(--logistic-hover-bg); hover:border-color: var(--logistic-border-accent);">
                        <i class="fas fa-undo text-lg mr-3 transition-transform duration-200 flex-shrink-0 text-orange-500"></i>
                        <span class="transition-all duration-300 opacity-100 whitespace-nowrap">Retournées</span>
                    </a>
                </li>
            </ul>
        </div>



        <!-- Parametres Dropdown -->
        <div class="mb-2">
            <div id="dropdown-parametres" class="flex items-center justify-between px-4 py-2 cursor-pointer hover:bg-opacity-20 hover:bg-white transition-all duration-200" style="color: var(--logistic-text-light); opacity: 0.8; border-color: var(--logistic-border-accent);">
                <div class="flex items-center">
                    <i class="fas fa-cog mr-2 flex-shrink-0"></i>
                    <span class="transition-all duration-300 opacity-100 whitespace-nowrap">PARAMÈTRES</span>
                </div>
                <i id="chevron-parametres" class="fas fa-chevron-down text-sm transition-all duration-300 ease-in-out"></i>
            </div>
            <ul id="menu-parametres" class="ml-2 hidden transition-all duration-300 ease-in-out">
                <li>
                    <a href="{% url 'operatLogistic:profile' %}" class="flex items-center px-4 py-2 transition-all duration-200 transform hover:translate-x-1 border-l-4 border-transparent hover:shadow-lg" style="color: var(--logistic-text-light); hover:background-color: var(--logistic-hover-bg); hover:border-color: var(--logistic-border-accent);">
                        <i class="fas fa-user-cog mr-3 transition-transform duration-200 flex-shrink-0" style="color: var(--logistic-text-light); opacity: 0.8;"></i>
                        <span class="transition-all duration-300 opacity-100 whitespace-nowrap">Mon profil</span>
                    </a>
                </li>
            </ul>
        </div>
    </nav>
    
    <!-- Bouton de déconnexion avec animation -->
    <div class="absolute bottom-4 left-4 right-4" id="logout-section">
        <form method="post" action="{% url 'logout' %}">
            {% csrf_token %}
            <button type="submit" class="flex items-center justify-center w-full px-4 py-3 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white rounded-lg transition-all duration-300 transform hover:scale-105 hover:shadow-lg">
                <i class="fas fa-sign-out-alt mr-2 transition-transform duration-200 flex-shrink-0"></i>
                <span id="nav-text-logout" class="transition-all duration-300 opacity-100 whitespace-nowrap">Déconnexion</span>
            </button>
        </form>
    </div>
</div>

<!-- Script ultra-simple et direct -->
<script>
(function() {
    'use strict';
    
    console.log('🔧 Sidebar script direct loading...');
    
    function initDropdowns() {
        console.log('🔧 Setting up direct dropdowns...');
        
        // Dropdown Commandes
        const dropdownCommandes = document.getElementById('dropdown-commandes');
        const menuCommandes = document.getElementById('menu-commandes');
        const chevronCommandes = document.getElementById('chevron-commandes');
        
        if (dropdownCommandes && menuCommandes && chevronCommandes) {
            dropdownCommandes.onclick = function(e) {
                e.preventDefault();
                console.log('✅ COMMANDES clicked');
                
                if (menuCommandes.classList.contains('hidden')) {
                    menuCommandes.classList.remove('hidden');
                    menuCommandes.style.display = 'block';
                    chevronCommandes.style.transform = 'rotate(180deg)';
                    console.log('✅ COMMANDES opened');
                } else {
                    menuCommandes.classList.add('hidden');
                    menuCommandes.style.display = 'none';
                    chevronCommandes.style.transform = 'rotate(0deg)';
                    console.log('✅ COMMANDES closed');
                }
            };
        }
        
        // Dropdown Parametres
        const dropdownParametres = document.getElementById('dropdown-parametres');
        const menuParametres = document.getElementById('menu-parametres');
        const chevronParametres = document.getElementById('chevron-parametres');
        
        if (dropdownParametres && menuParametres && chevronParametres) {
            dropdownParametres.onclick = function(e) {
                e.preventDefault();
                console.log('✅ PARAMETRES clicked');
                
                if (menuParametres.classList.contains('hidden')) {
                    menuParametres.classList.remove('hidden');
                    menuParametres.style.display = 'block';
                    chevronParametres.style.transform = 'rotate(180deg)';
                    console.log('✅ PARAMETRES opened');
                } else {
                    menuParametres.classList.add('hidden');
                    menuParametres.style.display = 'none';
                    chevronParametres.style.transform = 'rotate(0deg)';
                    console.log('✅ PARAMETRES closed');
                }
            };
        }
        
        // Dropdown Service
        const dropdownService = document.getElementById('dropdown-service');
        const menuService = document.getElementById('menu-service');
        const chevronService = document.getElementById('chevron-service');
        
        if (dropdownService && menuService && chevronService) {
            dropdownService.onclick = function(e) {
                e.preventDefault();
                console.log('✅ SERVICE clicked');
                
                if (menuService.classList.contains('hidden')) {
                    menuService.classList.remove('hidden');
                    menuService.style.display = 'block';
                    chevronService.style.transform = 'rotate(180deg)';
                    console.log('✅ SERVICE opened');
                } else {
                    menuService.classList.add('hidden');
                    menuService.style.display = 'none';
                    chevronService.style.transform = 'rotate(0deg)';
                    console.log('✅ SERVICE closed');
                }
            };
        }
        
        // Dropdown Stock
        const dropdownStock = document.getElementById('dropdown-stock');
        const menuStock = document.getElementById('menu-stock');
        const chevronStock = document.getElementById('chevron-stock');
        
        if (dropdownStock && menuStock && chevronStock) {
            dropdownStock.onclick = function(e) {
                e.preventDefault();
                console.log('✅ STOCK clicked');
                
                if (menuStock.classList.contains('hidden')) {
                    menuStock.classList.remove('hidden');
                    menuStock.style.display = 'block';
                    chevronStock.style.transform = 'rotate(180deg)';
                    console.log('✅ STOCK opened');
                } else {
                    menuStock.classList.add('hidden');
                    menuStock.style.display = 'none';
                    chevronStock.style.transform = 'rotate(0deg)';
                    console.log('✅ STOCK closed');
                }
            };
        }
        
        console.log('🚀 Direct dropdowns ready!');
    }
    
    // Multiple méthodes d'initialisation
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initDropdowns);
    } else {
        initDropdowns();
    }
    
    // Fallback
    setTimeout(initDropdowns, 100);
    setTimeout(initDropdowns, 500);
    setTimeout(initDropdowns, 1000);
    
})();
</script>
