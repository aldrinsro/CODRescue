<!-- Pagination réutilisable pour les pages de préparation -->
{% if paginator.num_pages > 1 %}
<div class="bg-white rounded-xl shadow-lg border p-6 mt-6" style="border-color: var(--preparation-border-accent);">
    <div class="flex flex-col sm:flex-row items-center justify-between gap-4">
        <!-- Informations de pagination -->
        <div class="text-sm text-gray-700">
            <span class="font-medium">Page {{ current_page }}</span>
            sur
            <span class="font-medium">{{ total_pages }}</span>
            ({{ paginator.count }} commande{{ paginator.count|pluralize }} au total)
        </div>

        <!-- Contrôles de pagination -->
        <div class="flex items-center space-x-2">
            <!-- Bouton Précédent -->
            {% if has_previous %}
                <a href="?page={{ previous_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}{% if filter_type and filter_type != 'all' %}&filter={{ filter_type }}{% endif %}{% if items_per_page != 10 %}&per_page={{ items_per_page }}{% endif %}" 
                   class="inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors duration-200">
                    <i class="fas fa-chevron-left mr-1"></i>
                    Précédent
                </a>
            {% else %}
                <span class="inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-400 bg-gray-100 cursor-not-allowed">
                    <i class="fas fa-chevron-left mr-1"></i>
                    Précédent
                </span>
            {% endif %}

            <!-- Numéros de page -->
            <div class="flex items-center space-x-1">
                {% for page_num in paginator.page_range %}
                    {% if page_num == current_page %}
                        <span class="inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white" 
                              style="background-color: var(--preparation-primary);">
                            {{ page_num }}
                        </span>
                    {% elif page_num <= 3 or page_num > paginator.num_pages|add:"-3" or page_num >= current_page|add:"-2" and page_num <= current_page|add:"2" %}
                        <a href="?page={{ page_num }}{% if search_query %}&search={{ search_query }}{% endif %}{% if filter_type and filter_type != 'all' %}&filter={{ filter_type }}{% endif %}{% if items_per_page != 10 %}&per_page={{ items_per_page }}{% endif %}" 
                           class="inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors duration-200">
                            {{ page_num }}
                        </a>
                    {% elif page_num == 4 and current_page > 5 %}
                        <span class="inline-flex items-center px-3 py-2 text-sm leading-4 font-medium text-gray-500">
                            ...
                        </span>
                    {% elif page_num == paginator.num_pages|add:"-3" and current_page < paginator.num_pages|add:"-4" %}
                        <span class="inline-flex items-center px-3 py-2 text-sm leading-4 font-medium text-gray-500">
                            ...
                        </span>
                    {% endif %}
                {% endfor %}
            </div>

            <!-- Bouton Suivant -->
            {% if has_next %}
                <a href="?page={{ next_page_number }}{% if search_query %}&search={{ search_query }}{% endif %}{% if filter_type and filter_type != 'all' %}&filter={{ filter_type }}{% endif %}{% if items_per_page != 10 %}&per_page={{ items_per_page }}{% endif %}" 
                   class="inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors duration-200">
                    Suivant
                    <i class="fas fa-chevron-right ml-1"></i>
                </a>
            {% else %}
                <span class="inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-400 bg-gray-100 cursor-not-allowed">
                    Suivant
                    <i class="fas fa-chevron-right ml-1"></i>
                </span>
            {% endif %}
        </div>

        <!-- Sélecteur d'éléments par page -->
        <div class="flex items-center space-x-2">
            <label for="per_page_select" class="text-sm text-gray-700">Éléments par page:</label>
            <select id="per_page_select" 
                    class="block w-20 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 text-sm"
                    onchange="changePerPage(this.value)">
                <option value="5" {% if items_per_page == 5 %}selected{% endif %}>5</option>
                <option value="10" {% if items_per_page == 10 %}selected{% endif %}>10</option>
                <option value="25" {% if items_per_page == 25 %}selected{% endif %}>25</option>
                <option value="50" {% if items_per_page == 50 %}selected{% endif %}>50</option>
                <option value="100" {% if items_per_page == 100 %}selected{% endif %}>100</option>
            </select>
        </div>
    </div>
</div>
{% endif %}
